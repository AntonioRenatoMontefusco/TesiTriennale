\documentclass[12pt, openany]{book}
\usepackage[italian]{babel}
\usepackage{xcolor}
\usepackage{float}
\usepackage{graphicx}
\newcommand\myworries[1]{\textcolor{red}{#1}}
\begin{document}
	\chapter*{Intruduzione}	
		Il CoronaVirus-19, abbreviato CoViD-19, è un virus trovato per la prima volta a Wuhan, in Cina. Esso è conosciuto anche come \emph{Malattia respiratoria acuta}, abbreviato in \textbf{SARS-CoV-2}, dato che è un virus che come principale metodo di trasmissione utilizza le vie aeree ha avuto vita facile nel diffondersi velocemente, in effetti tutti respiriamo. In breve tempo si è passati dall'isolamento della Cina al doverlo definire \textbf{pandemia} e quindi passare ad un isolamento globale.
		Per la sua facilità di diffusione e per la sua pericolosità per alcuni soggetti più deboli è stato necessario modificare lo stile di vita a cui si era abituati, iniziando con i lockdown, dovendo passare alla didattica a distanza perdendo la socialità dei luoghi di studio, abbiamo visto l'economia rallentare, nei casi peggiori crollare e la socialità in presenza scomparire per via della chiusura temporanea di aziende e luoghi definiti "non di prima necessità".
		Questa situazione ha dato una motivazione per effettuare studi e ricerche in questo ambito, sia per ridurre i sintomi del virus, in buona parte già sta avvenendo con i vari vaccini, sia per permettere alle persone di incontrarsi e lavorare come prima della pandemia trovando metodi per ridurre i contagi come le mascherine. In Italia stiamo allentando la presa sulle restrizioni grazie anche all'avvento del \emph{GreenPass} il quale permette di certificare che si è vaccinati o che si hanno gli anticorpi dovuti ad un'infezione da CoViD-19. Questo però non ferma il contagio dato che il vaccino permette agli individui di avere sintomi più lievi ma è comunque possibile essere contagiati e diffondere il virus. 
		Uno degli aspetti che coinvolge un po' tutte le persone, sia per divertimento che per lavoro è il trasporto pubblico. Non tutti hanno un mezzo di trasporto proprio o per molti addirittura non conviene, basti pensare alle grandi città con lunghe code per il traffico a tal punto da fare prima a far il tragitto a piedi. Quindi molti optano per i trasporti pubblici ma qui è dove avvengono i principali contagi dovuti ai luoghi chiusi, stretti e poco arieggiati che impediscono di seguire perfettamente le normative dettate dal governo e dall'Organizzazione Mondiale della Sanità (OMS); questo è uno dei principali motivi del lavoro di tesi.\\
		L'obbiettivo del progetto di tesi è quello di creare una simulazione ad agenti estendibile a diversi tipi di percorsi e abitudini cittadine diverse, da cui recuperare dati sulle persone e sui contagi che avvengono su un mezzo di trasporto pubblico (nel nostro caso si tratta di un autobus). La simulazione è stata realizzata interamente in Unity3D,un motore grafico di che consente lo sviluppo di contenuti interattivi digitali, sia 2D che 3D, come ad esempio videogiochi e simulazioni. Sono stati anche utilizzati tool ed algoritmi per risolvere  vari problemi , come ad esempio abbiamo utilizzato \emph{A* Pathfinding Project} a cura di Aron Granberg per il calcolo del percorso degli agenti. 
		\\Gli agenti vengono distinti in:
		\begin{itemize}
			\item Sano, indicato in verde
			\item Contagioso, indicato in rosso
			\item Infetto, indicato in giallo
			
		\end{itemize} 
		
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/Agenti"}
		\caption{Stati degli agenti}
		\label{fig:agenti}
	\end{figure}

		come è visibile nella Figura \ref{fig:agenti}\\
		I dati sul numero di pendolari della tratta sono stati presi da un articolo riguardante uno studio pre-pandemia sui viaggiatori della cittadina giapponese di Obuse\cite{Obuse}, della quale è stato preso il percorso della tratta del bus. La simulazione permette di selezionare la percentuale di contagiati iniziale e la percentuale di infezione del virus in modo tale da effettuare facilmente diversi test. Il numero di persone alle fermate è selezionabile per ogni singola fermata in modo tale da poter essere utilizzate in diversi percorsi o più semplicemente applicarlo alle stime dei pendolari attuali.\\
		All'avvio della simulazione viene generato un file .csv che verrà riempito per ogni tratta del bus con le informazioni generate sugli agenti, come il numero i agenti totali, quelli contagiosi, quelli infetti e quelli sani.
		\\
		La tesi sarà suddivisa nelle seguenti sezioni:
		\begin{itemize}
			\item \textbf{Stato dell'arte}: verrà mostrato lo stato delle ricerche sulla diffusione del CoViD-19 in ambito di trasporti pubblici, citando elaborati e mostrandone i punti di forza e le limitatezze.
			\item \textbf{Presentazione delle tecnologie}: in questa sezione verrà mostrato in dettaglio le tecnologie utilizzate per la creazione della simulazione.
			\item\textbf{Simulazione nel dettaglio}: verrà mostrato il lavoro svolto per la realizzazione della simulazione mostrando in dettaglio i vari oggetti, come sono stati utilizzati i tool e il lavoro svolto senza tool.
			\item\textbf{Risultati ottenuti}: verrà mostrato i risultati ottenuti da vari test della simulazione.
			\item\textbf{Conclusione e sviluppi futuri}: si analizzeranno le limitazioni del lavoro allo stato attuale e si metteranno in risalto idee per sviluppi futuri
		\end{itemize}
	\chapter{Stato dell'arte}
		Dalla scoperta del salto di specie effettuato dal CoViD-19 sull'essere umano ad oggi ci sono stati innumerevoli studi, ricerche su vari aspetti della malattia, sul suo impatto sulla società in ambito politico,sociale ed economico. Ci sono anche varie simulazioni sulla sua diffusione in varie situazioni come trasporti pubblici, uffici, ospedali, locali pubblici. \\
		Come primo articolo si parlerà di "Simulaion-based Estimation of the Spread of COVID-19 in Iran"\cite{Iran} pubblicato il 27 Marzo 2020 su medRxiv. Come primo luogo l'articolo mette in luce i problemi dovuti ai dati provenienti dai vari paesi colpiti dal virus, definendoli altamente inaffidabili perché non tengono conto che i sintomi lievi del CoViD-19 sono assimilabili al raffreddore stagionale o alla comune influenza, in più molti testi vengono effettuati tramite screening limitati, un metodo per effettuare esami a tappeto allo scopo di individuare una malattia. Tutti questi dati non vengono combinati con le statistiche ufficiali sulla diffusione del virus e si va quindi a sottovalutare la quantità di infetti.
		Lo studio è stato effettuato sulla diffusione del virus in Iran nei primi mesi del 2020.\\
		È stato sviluppato un modello dinamico per fornire un quadro affidabile dello stato della malattia basandosi sui dati esistenti. Il modello si basa sul framework \textbf{SEIR}(Suscettibile, Esposto, Infetto, Ricoverato); 
		\begin{figure}[H]
			\centering
			\includegraphics[width=1\linewidth]{"Immagini/SEIR"}
			\caption{Questo è la rappresentazione di un modello SEIR }
			\label{fig:SEIR}
		\end{figure}
		I modelli matematici, in epidemiologia, sono modelli simbolici costituiti da una o più equazioni che considerano diversi parametri per prevedere l'andamento di una malattia in diverse condizioni ambientali o per calcolare il rischio di morte o l'aspettativa di vita nel corso di una pandemia di specifiche entità. SEIR è uno di questi modelli matematici, esso considera il periodo di incubazione durante il quale un individuo è infetto ma non contagioso, in questo caso si trova nello stato di \emph{"Esposto"}, questo è il principale motivo per cui è stato scelto questo modello, tenendo conto il periodo di incubazione del CoVid-19 che ha un massimo di 14 giorni.\\
		Come primo parametro è stato registrata la frequenza di contatti medi tra persone man mano che venivano segnalati i decessi, poi sono stati differenziati i casi segnalati dai casi effettivi e di come questa differenza cambia con l'andare dell'epidemia(all'epoca ancora definibile epidemia). Nel modello sono stati utilizzati sia dati ufficiali che dati stimati dalla comunità medica in modo tale da ricostruire un quadro più completo della situazione epidemica. Questi dati vengono raccolti per poi passare ad un simulazione con metodo \emph{Monte Carlo}; è una classe di metodi computazionali basati sul campionamento casuale per ottenere risultati numerici, questo metodo è utilizzato per trarre stime attraverso simulazioni.
		Da quest'analisi sono state trovate sei possibili situazioni della diffusione della malattia in relazione ad effetti stagionali e misure di distanziamento sociale.\\
		I risultati dello studio mostra che il vero numero di casi probabilmente è molto più grande di quello effettivamente registrato, quasi il doppio degli infetti. Lo studio avverte sul fatto che i dati potrebbero dichiarare molti meno casi di quelli che sono nella realtà portando la popolazione e i governi a sottovalutare la situazione.
		\\
		\\
		Il prossimo documento di cui si parlerà è \emph{"How simulation modelling can help reduce the impact of COVID-19"}\cite{Simulazioni} a cura della professoressa Christine Currie pubblicato dal \emph{CORMSIS}, centro di ricerca operativa e statistica dell'Università del Southamoton, il 15 Aprile 2020 su Taylor\&Francis Online il quale tratta dei vari modelli utilizzati dai governi e dall'Organizzazione Mondiale della Sanità per decidere le migliori strategie per debellare la minaccia del CoViD-19. I modelli utilizzati sono modelli epidemiologici volti a comprendere la diffusione della malattia. In quest'articolo verranno discussi di come i vari modelli di simulazione potrebbe aiutare a prendere decisioni.
		Il presente articolo presenta due obbiettivi, il primo è dare una guida ai diversi modelli di simulazioni e quali tipi possono essere utili a prendere decisioni durante un'emergenza sanitaria; il secondo è una \emph{"Chiamata alle armi"} dei modellatori di simulazioni per migliorare le ricerche.
		I modelli di tipo epidemiologico sono un'idea per predire il numero di nuovi casi identificando le migliori misure per ridurre i contagi, ma non aiutano ad organizzare l'organizzazione delle terapie intensive all'interno degli ospedali. Come nel paper precedente anche nel presente si indica il modello \emph{SEIR} come il modello più popolare per descrivere l'attuale pandemia per via del tempo di incubazione dato dallo stato di "Exposed".\\
		Questo paper considera quattro metodi di modellazione:
		\begin{itemize}
			\item \emph{Sistemi dinamici}: è un modello basato su equazioni differenziali che rappresentano azioni nel mondo.
			\item \emph{Modello basato ad agenti} può essere utilizzato per modellare l'interazione tra gli individui. In questi modelli utilizzati per monitorare la diffusione di una malattia è molto importante gestire le reti sociali e i movimenti nello spazio.
			\item \emph{Simulazione ad eventi discreti}, il sistema è rappresentato, nella sua evoluzione nel tempo, con variabili che cambiano istantaneamente il loro valore in ben definiti istanti di tempo appartenenti ad un insieme numerabili, questi istanti sono definiti eventi.
			\item \emph{Simulazione ibrida}: sono modelli che combinano due o più tecniche di modellazione citate precedentemente.
		\end{itemize}
	Dato che le simulazioni sviluppate con i metodi descritti in precedenza possono diventare molto complesse e richiedere tempo per l'esecuzione sono state sviluppate le simulazioni distribuite, le quali permettono di collegare più simulazioni in una singola in scala maggiore permettendo una velocità maggiore.\\ 
	Di seguito il presente paper introduce le tipologie di decisioni che sono state prese grazie all'utilizzo di simulazioni durante la pandemia da CoViD-19; esse vengono divise in tre sezioni:
	\begin{itemize}
		\item \emph{Decisioni che hanno avuto effetto sulla diffusione del virus.}
		\item \emph{Decisioni che riguardano la gestione delle risorse.}
		\item \emph{Decisioni sulla salute della popolazione.}
	\end{itemize}
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.8\linewidth]{"Immagini/Decisioni"}
		\caption{Questo è uno schema sulle decisioni consigliate dal risultato di diverse tipologie di modelli per le simulazioni.}
		\label{fig:decisioni}
	\end{figure}
 	La Figura \ref{fig:decisioni} mette in luce le diverse decisioni suggerite dalle quattro tipologie di modelli in base a scala organizzativa e fase di emergenza.
	Ora andiamo più nel dettaglio nelle decisioni per evitare la diffusione del virus descritte nel presente paper.\\
	Come prima decisione possibile abbiamo quella della \emph{quarantena}, questo per evitare del tutto la diffusione del virus. Questa decisione è d'obbligo una volta individuato un caso di corona virus, questo fino alla sua completa guarigione in modo tale da non poter contagiare nessuno. L'articolo cita un articolo del 2016 intitolato "The Ebola crisis and the corresponding public behavior: A system dynamics approach" il quale dimostra di come la messa in quarantena dei casi di ebola ha avuto un impatto importante su combattere la malattia; questo però non è applicabile così facilmente alla pandemia da corona virus dato che i sintomi dell'ebola sono ben visibili sulla pelle dei malcapitati, a differenza di quelli da CoViD-19 che possono anche essere lievi o assenti.\\
	Una seconda decisione che ha avuto un grande impatto sul nostro stile di vita, ma allo stesso è stato di grande aiuto per combattere la diffusione del virus sono le misure di \emph{distanziamento sociale}. Per distanziamento sociale si intendono quei comportamenti nel quale riduciamo, in parte ,il contatto umano in modo tale da essere sicuri di essere contagiati o di contagiare e quindi puntare a ridurre la crescita della curva dei contagi. Esempi di distanziamento sociale possono essere: \begin{itemize}
		\item mantenere una distanza di sicurezza di circa due metri in modo tale da non far arrivare gocce di saliva alla persona con cui stiamo colloquiando
		\item lavorare da casa quando è possibile, infatti molte aziende sono passate allo smart-working, in modo tale da continuare a lavorare tranquillamente anche da casa.
		\item Cancellare eventi i quali prevedono un elevato numero di persone.
		\item chiudere le scuole e optare per le lezioni in remoto.
		\item evitare di incontrare fisicamente amici e parenti.
	\end{itemize}
	Un decisione molto più drastica delle due precedenti è il lock-down imposto dal governo in modo tale da costringere la popolazione al distanziamento sociale e a lasciare le abitazioni sono in caso di prima necessità, come andare a fare la spesa, andare a lavorare ed uscire per motivi di salute. Per ovviare a problemi legati all'economia ogni governo può includere una soglia di valori sul quando rilassare le restrizioni in modo tale da permettere ai lavoratori che non eseguono un lavoro considerato di "Prima necessità" di lavorare facendo girare l'economia.\\
	In conclusione il documento lascia un appello definendolo "The call to arms" invitando a sviluppare simulazioni in merito alla diffusione e ai comportamenti per combattere la diffusione del virus in modo tale da supportare la ricerca, per poi fare l'esempio dei "codebreakers" britannici insieme ad Alan Turing, durante la Seconda Guerra Mondiale, decriptarono Enigma mostrando che l'unione di un buon team risolve problemi difficili.\\
	Lo sviluppo delle simulazioni si è dimostrato essere molto efficace, basti pensare al fatto che questo paper è stato redatto il 27 Marzo 2020 e seguendo le decisioni suggerite dalle simulazioni stiamo pian piano tornando alla normalità.\\
	
	Esistono numerosi studi che utilizzano simulazioni riguardo al CoViD-19 per varie motivazioni, quali: allo scopo di fornire un modello per comprendere al meglio le dinamiche spazio-temporali della diffusione della pandemia
	 \cite{Singapore}; oppure allo scopo di predire i rischi nel rimuovere le limitazioni di movimento alla popolazione illustrando anche l'efficacia delle mascherine in ambienti di simulazioni a lungo termine.\cite{Madrid}; o ancora studi con dati meno accurati ottenuti con sondaggi telefonici durante le prime fasi di pandemia per avere dati aggiuntivi rispetto a quelli forniti da istituzioni governative. \cite{HongKong}.
	\chapter{Presentazione delle tecnologie}
	In questo capitolo verranno mostrate, nel dettaglio, tutte le tecnologie utilizzate per la realizzazione della simulazione.
	\section{Unity}
	In primo luogo abbiamo la base della simulazione, Unity\cite{Unity}, un motore grafico multipiattaforma sviluppato da Unity Technologies utilizzato per lo sviluppo di contenuti interattivi, quali: videogiochi; simulazioni; esperienze interattive con dispositivi di realtà aumentata. \\
	Possiamo dividere Unity in due sottosistemi, Unity Editor e Unity Engine. 
	\subsection{Unity Editor}
	Con Unity Editor si intende l'interfaccia grafica di Unity, la quale è costruita per rendere facili le interazioni da parte dell'utente, essa è completamente modificabile a piacere dell'utente che la possibilità di salvare il suo editor in profili per ogni situazione.\\
	Ora parleremo delle diverse componenti della UI dell'editor di Unity.
	\subsubsection{Inspector}
	Ogni oggetto in unity è descritto dal concetto di GameObject, il quale identifica ogni oggetto in Unity. Ogni GameObject è decorato dai cosidetti \emph{Components}, i quali possono essere di diverso genere e comprendono mesh, script(in C\#), animazioni, rigidBody(il quale gestisce le componenti fisiche di un GameObject) e molti altri.
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/Inspector"}
		\caption{Questo è l'inspector di un semplice cubo in Unity}
		\label{fig:Inspector}
	\end{figure}

	Come è possibile vedere nella figura \ref{fig:Inspector} l'inspector permette di aggiungere, rimuovere e modificare i \emph{component} dei GameObject.
	\subsubsection{Hierarchy}
	L'Hierarchy contiene tutti gli oggetti di scena, come si può intuire dal nome, gli oggetti vengono mostrati tramite una gerarchia ad albero dove come radice abbiamo la \emph{scena}.
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/Hierarchy"}
		\caption{Questa è l'Hierarchy della simulazione.}
		\label{fig:Hierarchy}
	\end{figure}
	Come si può vedere dalla figura \ref{fig:Hierarchy} possiamo vedere come radice abbiamo l'oggetto "Obuse" che è la scena principale della simulazione e come figli ci sono tutti gli oggetti di scena.
	\subsubsection{Project}
	La finestra \emph{Project} permette di gestire la directory del progetto nella quale sono presenti script, prefab, modelli, texture, file audio e scene.
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/Project"}
		\caption{Questa è la finestra Project della simulazione}
		\label{fig:Project}	
	\end{figure}
	Come è possibile vedere nella figura \ref{fig:Project} il progetto è diviso in diverse cartelle per avere un'organizzazione migliore delle risorse.
	
	\subsubsection{Scene}
		La finestra \emph{"Scene"} rappresenta la scena corrente, tutti i GameObject che sono nell'Hierarchy, come detto precedentemente, sono nella scena corrente. Dalla scena è possibile manipolare i GameObject con strumenti di traslazione, rotazione e ridimensionamento. Tramite il mouse e la tastiera possiamo navigare con facilità nella scena oppure per essere più rapidi è possibile fare focus sull'oggetto selezionato, o dall'Hierarchy o dalla scena, premendo il tasto \emph{F}.
		\begin{figure}[H]
			\centering
			\includegraphics[width=1\linewidth]{"Immagini/Scene.png"}
			\caption{Questa è la scena della simulazione}
			\label{fig:Scene}
		\end{figure}
	Dalla figura \ref{fig:Scene} possiamo vedere tutta la scena della simulazione, compresa di gui(Delineata dal quadrato con bordi bianchi)
	\subsubsection{Game}
		La finestra \emph{Game} viene utilizzata quando si esegue il progetto, si passa alla finestra di game con la quale è possibile effettuare testi direttamente da Unity. Allo stesso tempo è possibile modificare parametri dalla scena e dall'Inspector mentre il Game è in esecuzione.
		\begin{figure}[H]
			\centering
			\includegraphics[width=1\linewidth]{"Immagini/PausedGame.png"}
			\caption{Questo è il game in pausa}
			\label{fig:PausedGame}
		\end{figure}
	Nella figura \ref{fig:PausedGame} viene mostrato il game quando è in pausa prima di iniziare, a sinistra si possono vedere vari slider per la gestione dei parametri della simulazione, mentre a destra abbiamo dei menù dropdown per la selezione degli agenti nelle varie fermate.
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/PlayingGame.png"}
		\caption{Questo è il game una volta iniziato}
		\label{fig:PlayingGame}
	\end{figure}
	Nella figura \ref{fig:PlayingGame} viene mostrato il game in play, quindi cambia l'interfaccia, a sinistra abbiamo i vari bottoni per la gestione della velocità della simulazione, in alto a destra abbiamo l'orologio che scandisce il tempo della simulazione; il quale rispetta il tempo reale della tratta di Obuse e infine, in basso a destra, abbiamo i dati sugli agenti.
	\subsubsection{Animation e Animator}
		Come è stato detto in precedenza, gli agenti della simulazione sono completamente animati, quindi ora parleremo di Animazioni e Animator. La finestra Animator permette di creare e modificare le animazioni tramite la timeline dell'oggetto da animare. 
		\begin{figure}[H]
			\centering
			\includegraphics[width=1\linewidth]{"Immagini/Animation"}
			\caption{Questa è la finestra Animation dell'animazione \emph{"Sit to Stand"} dell'agente che gli permette di sedersi sull'autobus.}
			\label{fig:Animation}
		\end{figure}
		Come è possibile vedere dalla figura \ref{fig:Animation} sulla sinistra abbiamo le sezioni dell'agente da animare, in alto abbiamo la timeline e al centro abbiamo i frame corrispondenti alle sezioni in corrispondenza del frame nella timeline.\\
		Tutte le animazioni sono gestite dal component \emph{Animator}, una macchina a stati finiti in grado di gestire differenti stati e passare da uno stato all'altro attraverso transizioni. 
		\begin{figure}[H]
			\centering
			\includegraphics[width=1\linewidth]{"Immagini/Animator"}
			\caption{Questo è il component animator.}
			\label{fig:Animator}
		\end{figure}
		Dalla figura \ref{fig:Animator} è possibile vedere, sulla sinistra, la macchina a stati finiti che è l'animator; sulla destra invece abbiamo il focus di una transizione, più precisamente dallo stato  \emph{Dark Dance 3} a \emph{Dark Dance 4} la quale avviene quando la variabile \emph{mode} ha valore pari a 13, come è possibile vedere nella sezione \emph{conditions}.
	\subsection{Unity Engine}
	Abbiamo parlato della parte di interfaccia utente di Unity, ora parleremo di quello che c'è dietro la realizzazione di un applicativo in Unity.
	Il motore di Unity permette di gestire la fisica del mondo virtuale in modo semplice aggiungendo vari component ai gameObject, come il Rigidbody o i Collider. Più nello specifico il Rigidbody è un componente che permette ai GameObject di agire in risposta alle forze del mondo di gioco; ad esempio è possibile indicare se un oggetto deve essere soggetto alla gravità oppure è possibile bloccare rotazione o traslazione su uno specifico asse, tutto questo è possibile selezionarle all'interno dell'Inspector o tramite scripting in C\#.\\
	I Collider, invece, permettono di gestire la collisione tra gli oggetti, più nello specifico permette di ascoltare le collisioni che avvengono tra Collider e Rigidbody. I Collider hanno diverse forme per addatarli ad ogni situazione; ad esempio abbiamo il BoxCollider, Sphere Collider, MeshCollider, CapsuleCollider.
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/RigidBody.png"}
		\caption{Questo è un cubo in unity, a destra possiamo vedere l'inspector con i component Boc Collider e Rigidbody.}
		\label{fig:Rigidbody}
	\end{figure}
	Nella figura \ref{fig:Rigidbody} possiamo vedere un semplice cubo in unity e sulla destra il suo Inspector. Il component collider presenta parametri riguardo grandezza e posizione, e un campo \emph{"Is Trigger"} il quale indica che il collider è un trigger, cioè è attraversabile ed è possibile intercettare entrata,presenza all'interno e uscita di un oggetto. Mentre il Rigidbody presenta parametri per la massa, l'attrito e i vincoli sui movimenti e rotazione.
	\subsubsection{Telecamera}
	La camera in unity è uno dei GameObject più importanti, essa presenta due component principali:
	\begin{itemize}
		\item \textbf{Camera Component}, ciò che permette alla camera di riprendere il mondo di gioco
		\item \textbf{Audio Listener}, è il nostro "orecchio sul mondo di gioco" infatti ci permette di catturare i suoni prodotti dalle fonti sonore.
	\end{itemize}
	Il render della telecamera è gestito da una particolare figura geometrica chiamata \emph{frustum}, nel caso specifico della telecamera è definito frustum di visione, il quale permette per l'appunto, di vedere quello che è presente in esso. Ogni parametro del frustum è modificabile nel \emph{Camera component}.
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/frustum.png"}
		\caption{Questa è la figura geometrica frutum}
		\label{fig:frustum}
	\end{figure}
	\subsection{A* Pathfinding Project}
		A* Pathfinding Project\cite{A*} è un tool a cura di \emph{Aron Grandberg} che fa utilizzo del famoso algoritmo A* per il calcolo del percorso minimo.
		Ora introdurremo l'algoritmo per poi passare a descrivere nel dettaglio il tool.
		\textbf{A*} è un algoritmo di ricerca del tipo \emph{best-first} su grafi che individua un percorso da un nodo iniziale verso un nodo di destinazione. Ogni nodo ha un costo di entrata che rappresenta la distanza tra il nodo corrente e quello di inizio, e un valore che indica la distanza euristica dal nodo corrente a quello di destinazione, il costo del nodo è composto dalla somma dei due descritti precedentemente. L'algoritmo sceglie il nodo con costo totale minore, ricalcola il costo dei nodi vicini a quello scelto, continua così fino ad arrivare a destinazione.
		\begin{figure}[H]
			\centering
			\includegraphics[width=1\linewidth]{"Immagini/AStar"}
			\caption{Questo è un esempio dell'algoritmo su un grafo a griglia}
			\label{fig:AStar}
		\end{figure}
		Nella figura \ref{fig:AStar} possiamo vedere il percorso minimo calcolato con l'algoritmo A* in blu, in rosso possiamo vedere i nodi controllati, in verde quelli non controllati, mentre in nero abbiamo i nodi definiti come "ostacolo". 

		Ora andiamo nel dettaglio del tool di Aron Granberg. \\
		\emph{A* pathfinding project} permette di scegliere tra diversi tipologie di grafi in modo tale da adattarlo ad ogni situazione. Le tipologie di grafi sono le seguenti:
		\begin{itemize}
			\item \textbf{Grafo a griglia}, come dice il nome è un grafo che genera nodi seguendo un pattern a griglia, è un pattern molto utile soprattutto quando bisogna aggiornare il grafo a runtime. Il grafo a griglia permette anche di scegliere la forma effettiva dei nodi, come ad esempio è possibile scegliere tra nodi quadrati, esagonali o personalizzati; oltre ad ovviamente permettere di scegliere quanti vicini ha ogni nodo.
			\item \textbf{Grafo Navmesh}, è un grafo che esprime i dati sul pathfinding come mesh a forma di triangolo. È un grafo che permette il calcolo del percorso minimo molto velocemente anche perché contiene meno nodi del grafo a griglia, quindi l'algoritmo richiede meno ricerca.
			\item \textbf{Grafo a punti}, è il più semplice tra tutti i tipi di grafi, permette una elevata personalizzazione e consiste in un gruppo di punti collegati tra loro.
		\end{itemize}
	Una volta scelto il grafo è possibile scegliere anche un \emph{layer} per indicare quali GameObject sono ostacoli in modo tale da evitarli.
	Per avere una personalizzazione completa del grafo è presente uno script, denominato \emph{Graph Update Scene}, che permette di disegnare sul grafo delle aree e quindi impostare a piacimento i valori dei nodi di quell'area.
	Gli agenti che utilizzeranno il grafo per il calcolo del percorso minimo dovranno avere il due component principali, \emph{AIPath}, il quale permette di impostare vari parametri, come la velocità dell'agente o l'accelerazione. \emph{AIDestination Setter} il quale prende in input la destinazione dell'agente, il quale una volta impostata inizierà ad incamminarsi verso di essa. 
	
	\subsection{EasyRoad3D e Bézier Path Creator}
	EasyRoad3D e Bèzier Path Creator sono due tool che si basano sulle curve di Bézier, delle curve formate da 4 punti: uno di inizio, uno di fine e due per la curvatura. \\
	EasyRoad3d permette, come si può intuire dal nome, creare facilmente delle strade su Unity. Il tool permette una grande personalizzazione delle strade, in più è tutto gestibile dall'inspector e dalla scena, infatti è possibile inserire dei punti per la creazione della strada con un semplice \emph{shift+click}.\\
	Bézier Path Creator permette di disegnare un percorso tramite un insieme di punti e di modificare la curvatura del percorso seguendo le regole delle curve di Bézier. Sul percorso è possibile far muovere un GameObject facilmente assegnandogli lo script \emph{Path follower}, il quale permette anche di impostare la velocità.
	
	\subsection{Probuilder}
	Probuilder è un tool a cura di Unity stesso che permette di fare semplice modellazione direttamente in Unity, esso infatti è stato utilizzato recentemente per lo sviluppo di alcuni videogiochi, come ad esempio \emph{SUPERHOT, Lucky's Tale, Tacoma}.\\
	Oltre a fornire diversi strumenti per la modellazione 3D, permette anche di generare delle forme predefinite come scale, archi e porte. È inoltre fornito di un'interfaccia grafica che si sovrappone alla scena in modo tale da avere tutti i tool a portata di click.
	\subsection{Cinemachine}
	Cinemachine è un tool a cura di Unity che permette di gestire con molta facilità e senza bisogno di scrivere codice la telecamera in Unity, ad esempio è possibile disegnare un percorso da far seguire alla telecamera. Il tool si basa sulla gestione di telecamere virtuali gestite da un component definito \emph{Cinemacine brain}, dal quale è possibile passare da una camera all'altra e gestire le diverse inquadrature. È possibile utilizzare anche una timeline per passare da una camera all'altra in un tempo specifico. Oltre ad essere stato utilizzato per la creazione di videogiochi, è stato utilizzato per la realizzazione di \emph{Baymax Deams}, un'animazione in collaborazione con \emph{Disney Television Animation} con il quale hanno vinto un \emph{ Technology and Engineering Emmy Awards} il 7 aprile 2019.
	
	\chapter{Simulazione nel dettaglio}
	In questo capitolo si mostrerà il lavoro svolto per la realizzazione della simulazione. 
	Si è iniziato partendo da un modello di autobus recuperato dall'asset store di Unity.
	Come prima cosa è stata realizzata una semplice strada circolare con EasyRoad3D in modo tale da poter mettere gli oggetti di scena e iniziare a fare delle prove.
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/StradaBase.png"}
		\caption{Questa è la strada di prova}
		\label{fig:StradaBase}
	\end{figure}
	Nella figura \ref{fig:StradaBase} mostra la strada di prova utilizzata l'inizio della realizzazione della simulazione.\\
	Ora si parlerà dell'autobus, di come è stato creato ed utilizzato e di come ce ne siano state diverse versioni. 
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/SchoolBus.png"}
		\caption{Questo è stato il primo bus della simulazione}
		\label{fig:SchoolBus}
	\end{figure}
	Nella figura \ref{fig:SchoolBus} possiamo vedere un scuolabus in \emph{"low poly"} con tanto di animazioni e texture presenti nell'asset. Applicate delle piccole modifiche alle animazioni si è passati alla sperimentazione del tool A* pathfinding project, iniziando con un semplice cilindro come agente e provando a farlo salire sull'autobus. Dopo svariati tentativi nel quale non si era liberi di selezionare sezioni precise del bus dato il fatto che il modello scaricato era un blocco unico, compresi i posti a sedere e questa cosa era molto scomoda, soprattutto per gestire le sezioni calpestabili o meno del grafo di A*. Infatti non era permesso di selezionare le pareti dell'autobus per inserirle nel layer degli ostacoli in modo tale da indicarlo al grafo generato da A* Pathfinding Project.\\
	Si è poi deciso di passare ad un bus molto più semplice, costituito da cubi base di unity.
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/AutobusBase.png"}
		\caption{Questa è la prima versione dell'autobus realizzato in Unity}
		\label{fig:AutobusBase}
	\end{figure}
	Si è poi deciso di utilizzare il tool di Unity \emph{ProBuilder} per migliorare il bus della figura \ref{fig:AutobusBase} aggiungendo finestre, ruote, la rampa e semplici texture.

	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/BasicBus.png"}
		\caption{Questo è il bus finale ad 8 posti utilizzato per la simulazione di prova}
		\label{fig:BasicBus}
	\end{figure}
	Nella figura \ref{fig:BasicBus} si può vedere il bus creato con oggetti base di Unity per poi decidere di utilizzare il tool \emph{ProBuilder}, il quale ha permesso di modellare direttamente da unity senza l'utilizzo di applicativi esterni, per modificare al meglio le pareti in modo tale da creare le finestre per abbellire il modello. L'autobus presenta anche una rampa a scomparsa per rendere più facile la salita degli agenti sul bus.
	Con il nuovo autobus e la possibilità di assegnare i layer ai singoli elementi, è stato facilmente possibile far salire il primo agente sul bus.\\
	Ora che la salita sul bus è facilmente applicabile si è passati ad aggiungere una lista di \emph{"target"} davanti ai posti a sedere del bus, in modo tale da poterli assegnare ai vari agenti tramite script. Si è poi passati all'inserimento dei modelli degli agenti e quindi a lavorare sulle varie animazioni. Iniziando con l'animazione che va dallo stare in piedi allo stare seduto e poi quella da seduto allo stare in piedi.
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/AgentAnimator.png"}
		\caption{Questo è il component animator dell'agente}
		\label{fig:AgentAnimator}
	\end{figure}
	La figura \ref{fig:AgentAnimator} mostra sulla sinistra la macchina a stati finiti composta dagli stati in cui si può trovare l'agente, ogni stato ha la sua animazione. Sulla destra invece possiamo vedere una prospettiva sulla transizione che va dallo stato di \emph{idle} a quello di \emph{Stand to Sit}, come si può vedere in basso la transizione avviene quando la variabile booleana Sit ha valore pari a true.\\
	A questo punto della simulazione gli agenti si sedevano correttamente, ma spesso capitava che facessero percorsi strani o che camminassero sopra i posti a sedere, per questo motivo al bus sono stati aggiunti diversi GameObject con component \emph{Graph Update Scene}, in modo tale da poter penalizzare dei nodi del grafo per avere un percorso migliore per gli agenti.
	\begin{figure}[H]
		\centering
		\includegraphics[width=1\linewidth]{"Immagini/AreaGrafo.png"}
		\caption{Questo è il grafo definitivo della simulazione.}
		\label{fig:AreaGrafo}
	\end{figure}
	Nella figura \ref{fig:AreaGrafo} possiamo vedere diverse zone nel grafo: le zone verdi sono aree completamente calpestabili, quindi non modificate dal \emph{Graph Update Scene}; Le aree rosse sono aree calpestabili ma con penalità, per evitare che gli agenti scavalchino i sedili; le zone trasparenti con quadrati rossi sono zone non calpestabili. In più si può vedere il bus finale che è stato utilizzato nella simulazione definitiva di Obuse a 12 posti, in seguito se ne parlerà più approfonditamente.
	\bibliographystyle{plain}
	\bibliography{bib.bib}

\end{document}